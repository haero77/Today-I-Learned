# JVM êµ¬ì¡° 

<img width="868" alt="image" src="https://user-images.githubusercontent.com/65555299/231662218-6cf4c978-ae6a-4f9a-a640-9605a65a27bb.png">

![image](https://user-images.githubusercontent.com/65555299/231655267-54339336-67ed-4806-8d1c-b3d0c74dc531.png)



- ì‹¤í–‰ê³¼ì • ìš”ì•½
  - í´ë˜ìŠ¤ ë¡œë”ê°€ ì½”ë“œë¥¼ ì½ì–´ì„œ ë©”ëª¨ë¦¬ ì˜ì—­ì— íŠ¹ì„±ì— ë”°ë¼ ë°°ì¹˜ë¥¼ í•œë‹¤.
    - ì˜ˆ: staticì€ ë©”ì†Œë“œ ì˜ì—­ì— ë°°ì¹˜ 
  - ì‹¤í–‰ í•  ë•Œ, ì“°ë ˆë“œê°€ ë§Œë“¤ì–´ì§€ê³  ì“°ë ˆë“œì— ë§ê²Œ ìŠ¤íƒ, PC ë ˆì§€ìŠ¤í„°, ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ìŠ¤íƒ ë“±ì´ ë§Œë“¤ì–´ì§„ë‹¤
  - ì‹¤í–‰ ì—”ì§„ì„ í†µí•´ ë°”ì´íŠ¸ ì½”ë“œë¥¼ ê¸°ê³„ì–´ë¡œ ë³€í™˜
    - ì¸í„°í”„ë¦¬í„°ë¥¼ í†µí•´ í•œ ì¤„ì”© ë³€í™˜í•˜ë‹¤ê°€ ë°˜ë³µë˜ëŠ” ê²ƒì´ ìˆìœ¼ë©´ JITì»´íŒŒì¼ëŸ¬ê°€ ë°˜ë³µë˜ëŠ” ì½”ë“œë¥¼ í•œ ë²ˆì— ë„¤ì´í‹°ë¸Œ ì½”ë“œë¡œ ë³€í™˜. ì¸í„°í”„ë¦¬í„°ëŠ” ë³€í™˜ëœ ë„¤ì´í‹°ë¸Œ ì½”ë“œë¥¼ ë°”ë¡œ ì‚¬ìš©
  - GCì— ì˜í•´ ì°¸ì¡°ë˜ì§€ ì•ŠëŠ” ê°ì²´ ì œê±°. í™ ë©”ëª¨ë¦¬ ìµœì í™”

- JVMì€ í¬ê²Œ 4ê°€ì§€ ì»´í¬ë„ŒíŠ¸ë¡œ êµ¬ì„±
  - `í´ë˜ìŠ¤ ë¡œë” ì‹œìŠ¤í…œ` + `ë©”ëª¨ë¦¬` + `ì‹¤í–‰ ì—”ì§„` + `ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ì¸í„°í˜ì´ìŠ¤ & ë¼ì´ë¸ŒëŸ¬ë¦¬` 

---

### í´ë˜ìŠ¤ ë¡œë” ì‹œìŠ¤í…œ

- .class ì—ì„œ ë°”ì´íŠ¸ì½”ë“œë¥¼ ì½ê³  ë©”ëª¨ë¦¬ì— ì €ì¥
- ë¡œë”©: í´ë˜ìŠ¤ ì½ì–´ì˜¤ëŠ” ê³¼ì •
- ë§í¬: ë ˆí¼ëŸ°ìŠ¤ë¥¼ ì—°ê²°í•˜ëŠ” ê³¼ì •
- ì´ˆê¸°í™”: static ê°’ë“¤ ì´ˆê¸°í™” ë° ë³€ìˆ˜ì— í• ë‹¹


### ë©”ëª¨ë¦¬

![](https://blog.kakaocdn.net/dn/brvkNA/btrIPYdYwMf/C5wCqtVNLvu642vOaGyCBK/img.png)

**Runtime Data Areaë€?** <br>
ğŸ‘‰ JVMì´ OSë¡œë¶€í„° ìë°” í”„ë¡œê·¸ë¨ ì‹¤í–‰ì„ ìœ„í•œ ë°ì´í„°ì™€ ëª…ë ¹ì–´ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ í• ë‹¹ë°›ëŠ” ë©”ëª¨ë¦¬ ê³µê°„ì´ë‹¤.


- `ë©”ì†Œë“œ ì˜ì—­`
  - í´ë˜ìŠ¤ ë ˆë²¨ì˜ ì •ë³´(í´ë˜ìŠ¤ ì´ë¦„, ë¶€ëª¨ í´ë˜ìŠ¤ ì´ë¦„, ë©”ì†Œë“œ, ë³€ìˆ˜) ì½”ë“œ ì €ì¥.
  - **ëª¨ë“  ì“°ë ˆë“œì—ì„œ ì‚¬ìš©í•˜ëŠ” ê³µìœ  ìì›**ì´ë‹¤.
  - JVM êµ¬ë™ ì‹œì‘ ì‹œ ìƒì„±, ì¢…ë£Œ ì‹œ ê¹Œì§€ ìœ ì§€
  - Runtime Constant Pool
    - 
  - (Java8 ë¶€í„°ëŠ” static ë³€ìˆ˜ê°€ í™ ì˜ì—­ì— ì €ì¥)
- `í™ ì˜ì—­`
  - new ì—°ì‚°ìë¥¼ í†µí•´ ìƒì„±ëœ ê°ì²´(=ì¸ìŠ¤í„´ìŠ¤. ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ í¬í•¨)ë¥¼ ì €ì¥. 
  - **ëª¨ë“  ì“°ë ˆë“œì—ì„œ ì‚¬ìš©í•˜ëŠ” ê³µìœ ìì›**ì´ë‹¤.
  - ê°ì²´ê°€ ë” ì´ìƒ ì“°ì´ì§€ ì•Šê±°ë‚˜ null ì„ ì–¸ ì‹œ GCê°€ ì²­ì†Œ
- `ìŠ¤íƒ ì˜ì—­`
  - ì“°ë ˆë“œë§ˆë‹¤ ëŸ°íƒ€ì„ ìŠ¤íƒì„ ë§Œë“¤ê³ , ë©”ì†Œë“œ í˜¸ì¶œì„ ìŠ¤íƒ í”„ë ˆì„ì´ë¼ ë¶€ë¥´ëŠ” ë¸”ëŸ­ì„ ìŒ“ëŠ”ë‹¤.
  - ì“°ë ˆë“œë¥¼ ì¢…ë£Œí•˜ë©´ ëŸ°íƒ€ì„ ìŠ¤íƒë„ ì‚¬ë¼ì§„ë‹¤.
  - **_ìŠ¤íƒ, PCë ˆì§€ìŠ¤í„°, ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ìŠ¤íƒì€ íŠ¹ì • ì“°ë ˆë“œì— ì¢…ì†ë˜ëŠ” ìì›_**. ì“°ë ˆë“œê°„ ê³µìœ í•˜ì§€ ì•ŠëŠ”ë‹¤.
- PC(Program Counter) ë ˆì§€ìŠ¤í„° 
  - ì“°ë ˆë“œë§ˆë‹¤ ì“°ë ˆë“œ ë‚´ í˜„ì¬ ì‹¤í–‰í•  ìŠ¤íƒ í”„ë ˆì„ì„ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„°ê°€ ìƒì„±ëœë‹¤.
- ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ìŠ¤íƒ
  - ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ í˜¸ì¶œí•  ë•Œ ìƒê¸°ëŠ” ë©”ì„œë“œ ìŠ¤íƒ 
  - https://javapapers.com/core-java/java-jvm-run-time-data-areas/#Program_Counter_PC_Register

**Java7ì˜ PermGenê³¼ Java8ì˜ Metaspace**

Java7 HotSpot JVM êµ¬ì¡° <br>
![image](https://user-images.githubusercontent.com/65555299/231744348-6b61ece2-2bed-4bcd-a64d-f6ff11bae4c5.png)
<br> (ì¶œì²˜ - https://johngrib.github.io/wiki/java8-why-permgen-removed/)

Java8 HotSpot JVM êµ¬ì¡° <br>
![image](https://user-images.githubusercontent.com/65555299/231744375-921a8b13-f7a8-443a-9722-9cb0f4eb9e12.png)
<br> (ì¶œì²˜ - https://johngrib.github.io/wiki/java8-why-permgen-removed/)

- Permanent
  - í´ë˜ìŠ¤ ë‚´ë¶€ì˜ ë©”íƒ€ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ì˜ì—­
  - ë©”ì†Œë“œ ì˜ì—­ìœ¼ë¡œ ì‚¬ìš©ë˜ì—ˆìŒ
  - Java 8 ì´í›„ Metaspaceë¡œ ëŒ€ì²´ë¨
- Metaspace
  - permanentì˜ì—­ê³¼ëŠ” ë‹¤ë¥´ê²Œ native memoryì˜ì—­ìœ¼ë¡œì„œ jvmì´ ì•„ë‹Œ osì—ì„œ ê´€ë¦¬

### ì‹¤í–‰ ì—”ì§„

- ì¸í„°í”„ë¦¬í„° 
  - ë°”ì´íŠ¸ ì½”ë“œë¥¼ í•œ ì¤„ì”© ì»´íŒŒì¼ í•´ì„œ ì‹¤í–‰(í•œ ì¤„ ë§ˆë‹¤ `ë°”ì´íŠ¸ì½”ë“œ â¡ï¸ ê¸°ê³„ì–´` ë³€í™˜, ì‹¤í–‰)
  - ë§¤ë²ˆ ê°™ì€ ë°”ì´íŠ¸ ì½”ë“œë¥¼ ê¸°ê³„ì–´ë¡œ ë°”ê¾¸ëŠ” ê²ƒì€ ë¹„íš¨ìœ¨ì  
- JIT(Just-In-Time) ì»´íŒŒì¼ëŸ¬
  - ì¸í„°í”„ë¦¬í„°ì˜ íš¨ìœ¨ì„ ë†’ì´ê¸° ìœ„í•´ ì‚¬ìš©
  - ì¸í„°í”„ë¦¬í„°ê°€ ë°˜ë³µë˜ëŠ” ë©”ì„œë“œ í˜¸ì¶œì„ ë°œê²¬í•˜ë©´ JIT ì»´íŒŒì¼ëŸ¬ë¡œ ë°˜ë³µë˜ëŠ” ì½”ë“œë¥¼ ëª¨ë‘ ë„¤ì´í‹°ë¸Œ ì½”ë“œë¡œ ë°”ê¿”ë‘”ë‹¤. ê·¸ ë‹¤ìŒë¶€í„° ì¸í„°í”„ë¦¬í„°ëŠ” ë„¤ì´í‹°ë¸Œ ì½”ë“œë¡œ ì»´íŒŒì¼ëœ ì½”ë“œë¥¼ ë°”ë¡œ ì‚¬ìš©í•œë‹¤.
    > It is used to increase the efficiency of an interpreter. It compiles the entire bytecode and changes it to native code _**so whenever the interpreter sees repeated method calls**_, JIT provides direct native code for that part so re-interpretation is not required, thus efficiency is improved.
- â­ï¸ **GC(Garbage Collector)**
  - ë”ì´ìƒ ì°¸ì¡°ë˜ì§€ ì•ŠëŠ” ê°ì²´ë¥¼ ëª¨ì•„ì„œ ì •ë¦¬í•œë‹¤.
  - "_ê°€ë¹„ì§€ ì»¬ë ‰í„°ëŠ” ì´í•´ë„ í•´ì•¼ë˜ê³ , ê²½ìš°ì— ë”°ë¼ ì˜µì…˜ì„ ì¡°ì •í•´ì•¼í•  ë•Œë„ ìˆë‹¤._"

### JNI(Java Native Interface: ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ì¸í„°í˜ì´ìŠ¤)

- ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ì‚¬ìš©ì‹œ ë™ì‘ê³¼ì • ì˜ˆì‹œ
  - `Thread.currentThread()`í˜¸ì¶œ
  - ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ìŠ¤íƒ ìƒì„±
  - ë‚´ë¶€ì ìœ¼ë¡œ JNIë¥¼ í˜¸ì¶œí•´ì„œ ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©

<br>

**â€» Reference**

- https://www.geeksforgeeks.org/jvm-works-jvm-architecture/
- _**https://dzone.com/articles/jvm-architecture-explained**_
- http://blog.jamesdbloom.com/JVMInternals.html
- [JVM ë‚´ë¶€ êµ¬ì¡° & ë©”ëª¨ë¦¬ ì˜ì—­ ğŸ’¯ ì´ì •ë¦¬](https://inpa.tistory.com/entry/JAVA-%E2%98%95-JVM-%EB%82%B4%EB%B6%80-%EA%B5%AC%EC%A1%B0-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EC%98%81%EC%97%AD-%EC%8B%AC%ED%99%94%ED%8E%B8#%ED%81%B4%EB%9E%98%EC%8A%A4_%EB%A1%9C%EB%8D%94_class_loader)
- [[ì¸í”„ëŸ°] ë°±ê¸°ì„  - ë” ìë°”, ì½”ë“œë¥¼ ì¡°ì‘í•˜ëŠ” ë‹¤ì–‘í•œ ë°©ë²•](https://www.inflearn.com/course/lecture?courseSlug=the-java-code-manipulation&unitId=23414&tab=curriculum)
- https://johngrib.github.io/wiki/java/run-time-constant-pool/
- https://8iggy.tistory.com/229
- https://goodgid.github.io/Java-8-JVM-Metaspace/
- https://seunghyunson.tistory.com/23
- https://1-7171771.tistory.com/140
- https://jgrammer.tistory.com/144