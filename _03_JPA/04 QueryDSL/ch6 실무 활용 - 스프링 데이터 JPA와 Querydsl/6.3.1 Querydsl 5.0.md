# Querydsl 5.0

## fetchResults()ì™€ fetchCount() ëŠ” ì‚¬ìš© X

- 5.0 ë¶€í„° fetchResults(), fetchCount() ë“±ì´ Deprecated ë˜ì—ˆìŒ.
- ë”°ë¼ì„œ fetchResults() ë¥¼ ì´ìš©í•œ ì»¨í…ì¸ , ì¹´ìš´íŠ¸ ì¿¼ë¦¬ë¥¼ í•œ ë°©ì— ì¡°íšŒëŠ” ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
  - **_ğŸ‘‰ ë¬´ì¡°ê±´ ì»¨í…ì¸ , ì¹´ìš´íŠ¸ ì¿¼ë¦¬ë¥¼ ë¶„ë¦¬í•´ì„œ ì‚¬ìš©í•œë‹¤._** 

## ì¹´ìš´íŠ¸ ì¿¼ë¦¬ ğŸ‘‰ fetch.size() ëŒ€ì‹  fetchOne()

```java
// count ì¿¼ë¦¬ (ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ë¡œìš°ì˜ ì´ ê°œìˆ˜ë¥¼ ì–»ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— í˜ì´ì§• ë¯¸ì ìš©)
Long total = queryFactory
        .select(member.count()) // SQL ìƒìœ¼ë¡œëŠ” count(member.id)ì™€ ë™ì¼
        .from(member)
        .leftJoin(member.team, team)
        .where(
                usernameEq(cond.getUsername()),
                teamNameEq(cond.getTeamName()),
                ageGoe(cond.getAgeGoe()),
                ageLoe(cond.getAgeLoe())
        )
        .fetchOne();
```

<br>

### size() ëŠ” ì‚¬ìš©í•˜ë©´ ì•ˆ ëœë‹¤ 

```java
long total = queryFactory
                .selectFrom(member)
                .leftJoin(member.team, team)
                .where(
                        usernameEq(cond.getUsername()),
                        teamNameEq(cond.getTeamName()),
                        ageGoe(cond.getAgeGoe()),
                        ageLoe(cond.getAgeLoe())
                )
                .fetch() // ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ì „ì²´ ë°ì´í„°ë¥¼ ì¡°íšŒ (List)
                .size(); // Listì˜ ê¸¸ì´ë¡œ totalì„ êµ¬í•˜ê¸°
```

- í˜ì´ì§•ì—ì„œ ì¹´ìš´íŠ¸ ì¿¼ë¦¬ë¥¼ ìœ„ì²˜ëŸ¼ êµ¬í•  ìˆ˜ë„ ìˆë‹¤.
- **_ê·¸ëŸ¬ë‚˜, Querydsl 5.0ê³¼ ê´€ê³„ ì—†ì´ `size()`ë¥¼ ì‚¬ìš©í•´ì„œëŠ” ì•ˆ ëœë‹¤._**
  - ë°ì´í„°ê°€ 1000ë§Œ ê±´ì´ë¼ë©´ `fetch()` ë¡œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ëª¨ë‘ ì˜¬ë¦¬ê¸° ë•Œë¬¸ì— ë°”ë¡œ `OOM`ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ê°€ ìˆë‹¤.

### Reference

- [ì¸í”„ëŸ° ì§ˆë‹µ - QueryDSL 5.0.0 ê¸°ì¤€ìœ¼ë¡œ ê°•ì˜ ë‚´ìš©ì„ ì •ë¦¬í–ˆëŠ”ë° ì˜¬ë°”ë¥´ê²Œ ì´í•´í•œ ê²ƒì¼ê¹Œìš”?](https://www.inflearn.com/questions/806452)
- [Querydslìœ¼ë¡œ ì•ˆì „í•œ ì¿¼ë¦¬ ì‘ì„±í•˜ê¸° + DataJPA](https://devwithpug.github.io/java/querydsl-with-datajpa/)