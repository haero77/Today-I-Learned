<!-- TOC -->
* [í¼ ì¸ì¦ - formLogin()](#í¼-ì¸ì¦---formlogin)
  * [í¼ ì¸ì¦?](#í¼-ì¸ì¦)
  * [formLogin()](#formlogin)
    * [ì‹¤ìŠµ](#ì‹¤ìŠµ)
    * [loginPage](#loginpage)
    * [usernameParameter, passwordParameter](#usernameparameter-passwordparameter)
    * [loginProcessingUrl](#loginprocessingurl)
    * [defaultSuccessUrl](#defaultsuccessurl)
    * [successHandler, failureHandler](#successhandler-failurehandler-)
  * [FormLoginConfigurer](#formloginconfigurer)
* [í¼ ì¸ì¦ í•„í„° - UsernamePasswordAuthenticationFilter](#í¼-ì¸ì¦-í•„í„°---usernamepasswordauthenticationfilter)
  * [í¼ ì¸ì¦ íë¦„ë„](#í¼-ì¸ì¦-íë¦„ë„)
    * [ì¸ì¦ì— ì„±ê³µí•œ ê²½ìš°](#ì¸ì¦ì—-ì„±ê³µí•œ-ê²½ìš°)
    * [ì¸ì¦ì— ì‹¤íŒ¨í•œ ê²½ìš°](#ì¸ì¦ì—-ì‹¤íŒ¨í•œ-ê²½ìš°)
    * [ì¸ì¦ ê³¼ì • ì¤‘ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ì˜ˆì™¸ ì²˜ë¦¬ëŠ” ì–´ë””ì„œ?](#ì¸ì¦-ê³¼ì •-ì¤‘-ì˜ˆì™¸ê°€-ë°œìƒí•˜ë©´-ì˜ˆì™¸-ì²˜ë¦¬ëŠ”-ì–´ë””ì„œ)
  * [ì‹¤ìŠµ](#ì‹¤ìŠµ-)
    * [ì¸ì¦ ì„±ê³µ ê³¼ì •](#ì¸ì¦-ì„±ê³µ-ê³¼ì •)
    * [ì¸ì¦ ì‹¤íŒ¨ ê³¼ì •](#ì¸ì¦-ì‹¤íŒ¨-ê³¼ì •)
* [ê¸°ë³¸ ì¸ì¦ - httpBasic()](#ê¸°ë³¸-ì¸ì¦---httpbasic)
  * [httpBasic()](#httpbasic)
  * [ê¸°ë³¸ ì¸ì¦ í•„í„° - BasicAuthenticationFilter](#ê¸°ë³¸-ì¸ì¦-í•„í„°---basicauthenticationfilter)
* [ê¸°ì–µí•˜ê¸° ì¸ì¦ - rememberMe()](#ê¸°ì–µí•˜ê¸°-ì¸ì¦---rememberme)
  * [rememberMe()](#rememberme)
  * [ê¸°ì–µí•˜ê¸° ì¸ì¦ í•„í„° - RememberMeAuthenticationFilter](#ê¸°ì–µí•˜ê¸°-ì¸ì¦-í•„í„°---remembermeauthenticationfilter)
* [ìµëª… ì¸ì¦ ì‚¬ìš©ì - anonymous](#ìµëª…-ì¸ì¦-ì‚¬ìš©ì---anonymous)
* [ë¡œê·¸ì•„ì›ƒ - logout()](#ë¡œê·¸ì•„ì›ƒ---logout)
* [ìš”ì²­ ìºì‹œ RequestCache / SavedRequest](#ìš”ì²­-ìºì‹œ-requestcache--savedrequest-)
<!-- TOC -->

# í¼ ì¸ì¦ - formLogin()

## í¼ ì¸ì¦?

![img.png](images/s02/form-auth/img.png)

- í´ë¼ì´ì–¸íŠ¸ê°€ `GET /user` API ë¡œ ìš”ì²­ì„ ë³´ëƒˆë‹¤ê³  í•˜ì.
- ê·¸ëŸ°ë° ì´ APIê°€ ê¶Œí•œì„ í•„ìš”ë¡œ í•˜ëŠ” API ì˜€ë‹¤ê³  í•˜ì.
- ê·¸ëŸ¼ ì‹œíë¦¬í‹°ê°€ ê°–ê³  ìˆëŠ” í•„í„° ì¤‘ ë§¨ ë§ˆì§€ë§‰ í•„í„°ì¸ AuthorizationFilter ê¶Œí•œ ê²€ì‚¬ í•„í„°ê°€ ìˆëŠ”ë°, ì—¬ê¸°ì„œ ì‚¬ìš©ìê°€ ê¶Œí•œì´ ìˆë‚˜ ì—†ë‚˜ ê²€ì‚¬í•˜ëŠ”ë° ì—¬ê¸°ì„œ 
  ê¶Œí•œì´ ì—†ì„ ê²½ìš° ì ‘ê·¼ ì˜ˆì™¸ë¥¼ ë°œìƒí•œë‹¤.
- ì´ ë–„ ì˜ˆì™¸ ì²˜ë¦¬ í•„í„°(`ExceptionTranslationFilter`)ê°€ ì´ ì˜ˆì™¸ë¥¼ ë°›ì•„ì„œ ì²˜ë¦¬í•˜ëŠ”ë°,
  - ì´ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ê°€ **ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸** ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤.
  - ê·¸ëŸ¼ ìœ ì €ëŠ” ë‹¤ì‹œ ë¡œê·¸ì¸ ì‹œë„ë¥¼ í•˜ê²Œ ëœë‹¤.

## formLogin()

![img_1.png](images/s02/form-auth/img_1.png)

### ì‹¤ìŠµ

![img_2.png](images/s02/form-auth/img_2.png)

![img_3.png](images/s02/form-auth/img_3.png)

- ìœ„ì²˜ëŸ¼ ì„¤ì •í•˜ê³  ë£¨íŠ¸ (`localhost:8080/`)ë¡œ ì´ë™í•´ë³´ì.

### loginPage

![img_4.png](images/s02/form-auth/img_4.png)

- ê·¸ëŸ¼ ìœ„ì™€ ê°™ì´ ì´ë™í•œë‹¤. ì™œ ê·¸ëŸ´ê¹Œ?

![img_5.png](images/s02/form-auth/img_5.png)

- ì¸ê°€ ìª½ì„ ë³´ë©´, ì–´ë–¤ ìš”ì²­ì´ë“ ê°„ì— ëª¨ë‘ ì¸ì¦ì„ í•„ìš”ë¡œ í•œë‹¤. (`auth.anyRequest().authenticated()`)
- ê·¸ëŸ°ë° ë£¨íŠ¸ë¡œ ì´ë™í•˜ë©´ ì¸ì¦ì„ í•˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ”ë°, ì´ ë•Œ ì‚¬ìš©ì ì •ì˜ ë¡œê·¸ì¸ í˜ì´ì§€ë¥¼ `/loginPage`ë¡œ ì •ì˜í•´ë†“ì•˜ìœ¼ë‹ˆ ê·¸ë¦¬ë¡œ ì´ë™í•œ ê²ƒì´ë‹¤. 
- `/loginPage`ì˜ ê²½ìš° **`permitAll()`ì„ ì„¤ì •í–ˆìœ¼ë¯€ë¡œ ì¸ì¦ì„ ë°›ì§€ ëª»í•œ ì‚¬ìš©ìë¼ í•˜ë”ë¼ë„ `/loginPage`ì— ì ‘ì† ê°€ëŠ¥**í•˜ë‹¤.

![img_6.png](images/s02/form-auth/img_6.png)

- `loginPage`ë¥¼ ì£¼ì„ ì²˜ë¦¬í•˜ê³  ë‹¤ì‹œ ë£¨íŠ¸ë¡œ ì´ë™í•˜ë©´ ìœ„ì™€ ê°™ì´ ê¸°ë³¸ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

### usernameParameter, passwordParameter

![img_8.png](images/s02/form-auth/img_8.png)

- `usernameParameter`ë¥¼ `userId`ë¡œ ì§€ì •í•˜ê³ ,
- `passwordParameter`ëŠ” `passwd`ë¡œ ì§€ì •í–ˆë‹¤. 
- ì´ëŸ¬ê³ ë‚˜ì„œ ê°œë°œìë„êµ¬ë¥¼ ì´ìš©í•˜ì—¬ ì‹œíë¦¬í‹° ê¸°ë³¸ ë¡œê·¸ì¸ í˜ì´ì§€ ë„êµ¬ë¥¼ ê²€ì‚¬í•˜ì 

![img_7.png](images/s02/form-auth/img_7.png)

- ìŠ¤í”„ë§ì—ì„œëŠ” HTML íƒœê·¸ì˜ `id`ê°’ì´ ì•„ë‹Œ `name`ê°’ì„ ì´ìš©í•˜ê¸° ë•Œë¬¸ì— `name` ê°’ì´ ê°ê° `userId`ì™€ `passwd`ë¡œ ë³€í•´ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
  - ì´ê²ƒì€ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ê°€ ìë™ìœ¼ë¡œ í•´ì¤€ ê²ƒìœ¼ë¡œ(ìš°ë¦¬ê°€ ì„¤ì •ì„ ì§ì ‘ í–ˆìœ¼ë¯€ë¡œ), ì»¤ìŠ¤í…€í•œ ë¡œê·¸ì¸ í¼ í˜ì´ì§€ë¥¼ ë§Œë“ ë‹¤ë©´ ì´ name ë¶€ë¶„ì„ ì„¤ì •í•œ ê°’ìœ¼ë¡œ ë§ì¶°ì¤˜ì•¼í•œë‹¤. 

### loginProcessingUrl

![img_9.png](images/s02/form-auth/img_9.png)

- form íƒœê·¸ì˜ action ê°’ì´ `loginProcessingUrl()` ì„¤ì •í•œ ê²½ë¡œë¡œ ë³€ê²½ë˜ì—ˆë‹¤.

### defaultSuccessUrl

![img_10.png](images/s02/form-auth/img_10.png)

- ë¡œê·¸ì¸ ì„±ê³µ ì´í›„ ì´ë™ í˜ì´ì§€ë¥¼ ë£¨íŠ¸ë¡œ ì„¤ì •í–ˆë‹¤. ì´ ìƒíƒœì—ì„œ ë¡œê·¸ì¸í•˜ë©´?

![img_11.png](images/s02/form-auth/img_11.png)

![img_12.png](images/s02/form-auth/img_12.png)

- ì˜¤í˜¸. ë£¨íŠ¸ë¡œ ì˜ ì´ë™í•œë‹¤.
- **_ê·¸ëŸ¼ `alwaysUse` ê°’ì„ `false`ë¡œ ì£¼ë©´ ì–´ë–»ê²Œ ë ê¹Œ?_**

![img_13.png](images/s02/form-auth/img_13.png)

- `alwaysUse` ê°’ì„ `false`ë¡œ ë³€ê²½í•œ ë‹¤ìŒì—, ì•±ì„ ì¬ê¸°ë™í•˜ê³  `/home`ìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚´ë³´ì.

![img_14.png](images/s02/form-auth/img_14.png)

![img_15.png](images/s02/form-auth/img_15.png)

- `/home`ìœ¼ë¡œ ìš”ì²­ì„ ë³´ëƒˆì§€ë§Œ, `/login`ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë˜ì—ˆë‹¤. (ìŠ¤í”„ë§ ê¸°ë³¸ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë˜ì—ˆë‹¤.)

![img_16.png](images/s02/form-auth/img_16.png)

![img_17.png](images/s02/form-auth/img_17.png)

- ì–´ë¼. ë¡œê·¸ì¸ì— ì„±ê³µí•˜ë‹ˆ, ì´ë²ˆì—ëŠ” ë£¨íŠ¸ë¡œ ê°€ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ `/home`ìœ¼ë¡œ ì´ë™í•œë‹¤. 
-  **_ì´ê²ƒì´ ë°”ë¡œ `alwaysUse`ê°’ì˜ true/false ì°¨ì´ì´ë‹¤._**
  -  `alwaysUse`ê°€ true ì´ë©´ ì–´ë–¤ ê²½ìš°ë“  ìƒê´€ ì—†ì´ defaultSuccessUrl ë¡œ ì´ë™í•œë‹¤.
  -  `alwaysUse`ê°€ falseì¼ ê²½ìš°, ì´ì „ì— ìš”ì²­ë°›ì€ ì£¼ì†Œë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ëœë‹¤.
    -  ì¦‰, **_ì¸ì¦ ì „ì— ë³´ì•ˆì´ í•„ìš”í•œ í˜ì´ì§€ë¥¼ ë°©ë¬¸í•˜ë‹¤ê°€ ì¸ì¦ì— ì„±ê³µí•œ ê²½ìš°ì´ë©´ ì´ì „ ìœ„ì¹˜ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ëœë‹¤._** (=ê¸°ë³¸ì ì¸ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ ì²˜ë¦¬ ë°©ì‹)

     
### successHandler, failureHandler 

- successHandler, failureHandler ëŠ” defaultSuccessUrlê³¼ failureUrlë³´ë‹¤ ìš°ì„ ì‹œ ëœë‹¤.

![img_18.png](images/s02/form-auth/img_18.png)

- ë¡œê·¸ì¸ ì„±ê³µí–ˆì„ ë•ŒëŠ” `/home`ìœ¼ë¡œ, ì‹¤íŒ¨ í–ˆì„ ë•ŒëŠ” `/login`ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ë„ë¡ ì„¤ì •í–ˆë‹¤.

![img_19.png](images/s02/form-auth/img_19.png)
![img_21.png](images/s02/form-auth/img_21.png)

- ë¡œê·¸ì¸ì— ì„±ê³µí–ˆì„ ë•Œ ì‹¤ì œ `/home`ìœ¼ë¡œ ê°€ëŠ” ê²ƒ í™•ì¸ ì™„ë£Œ.

![img_20.png](images/s02/form-auth/img_20.png)
![img_22.png](images/s02/form-auth/img_22.png)

- ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆì„ ë•Œ `/login`ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë˜ëŠ” ê²ƒ í™•ì¸ ì™„ë£Œ.

## FormLoginConfigurer

![img_23.png](images/s02/form-auth/img_23.png)

# í¼ ì¸ì¦ í•„í„° - UsernamePasswordAuthenticationFilter

![img_24.png](images/s02/form-auth/img_24.png)

- í´ë¼ì´ì–¸íŠ¸ë¡œ ë¶€í„° ìš”ì²­ì´ ì˜¤ë©´ `AbstractAuthenticationProcessingFilter`ê°€ ì¸ì¦ì„ ì²˜ë¦¬.
- `UsernamePasswordAuthenticationFilter`ëŠ” ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ê°€ êµ¬í˜„í•´ë‘” ì¸ì¦ í•„í„°. 

## í¼ ì¸ì¦ íë¦„ë„

![img_25.png](images/s02/form-auth/img_25.png)

- **RequestMatcher**
  - Request Mapping ì„ í™•ì¸í•œë‹¤.
  - ê¸°ë³¸ì ìœ¼ë¡œ `POST /login`ìœ¼ë¡œ ë§¤í•‘ë˜ì–´ìˆìœ¼ë¯€ë¡œ ë‹¤ë¥¸ URI, ì˜ˆë¥¼ ë“¤ë©´ `POST /login-process`ì˜ ê²½ìš°ëŠ” ë§¤ì¹­ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ 
    `RequestMatcher`ëŠ” `false`ë¥¼ ë¦¬í„´í•œë‹¤.
- **AuthenticationManager**
  - username, password ê¸°ë°˜ìœ¼ë¡œ ì¸ì¦ì„ ì²˜ë¦¬í•˜ëŠ” ë§¤ë‹ˆì €. ìì„¸í•œ ê²ƒì€ í›„ì— ë‹¤ë£¬ë‹¤.

### ì¸ì¦ì— ì„±ê³µí•œ ê²½ìš°

- **UsernamePasswordAuthenticationToken**
  - username, password ì™¸ì— user ì •ë³´(UserDetails)ì™€ ê¶Œí•œ ì •ë³´(Authorities)ë¥¼ í•¨ê»˜ ì €ì¥.
- **SecurityContextHolder**
  - (1) `Authentication`ì„ `SecurityContext`ì— ì„¤ì •
  - (2) ì„¸ì…˜ì— `SecurityContext`ê°€ ì €ì¥ë¨.
  - ìœ„ ë‘ ì‘ì—…ì„ í•˜ëŠ” ì´ìœ  -> **ìœ ì €ì˜ ì¸ì¦ ìƒíƒœ ìœ ì§€í•˜ê¸° ìœ„í•¨.**
- **RememberMeServices**
  - ì„¸ì…˜ì´ ë§Œë£Œë˜ì–´ë„ `ê¸°ì–µí•˜ê¸°` ê¸°ëŠ¥ì„ í†µí•´ ì‰½ê²Œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŒ.

### ì¸ì¦ì— ì‹¤íŒ¨í•œ ê²½ìš°

- `SecurityContextHolder`ë¥¼ ì‚­ì œí•œë‹¤.
  - ëˆ„êµ°ê°€ê°€ ì•…ì˜ì ìœ¼ë¡œ ë¡œê·¸ì¸ ì‹œë„ë¥¼ í–ˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ, ì¸ì¦ ì •ë³´ ìì²´ë¥¼ ì‚­ì œí•œë‹¤.
- `RememberMeServices.loginFail` í˜¸ì¶œ
  - ê¸°ì–µí•˜ê¸°ë„ ê°™ì´ ì‚­ì œ.

### ì¸ì¦ ê³¼ì • ì¤‘ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ì˜ˆì™¸ ì²˜ë¦¬ëŠ” ì–´ë””ì„œ?

- ì¸ì¦ì„ í•˜ë‹¤ê°€ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ì „ìš© ì˜ˆì™¸ í•„í„°ì—ì„œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, **ì¸ì¦ í•„í„°ì—ì„œ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í•œë‹¤.**
- ë³´í†µ `AuthenticationFailureHandler`ì—ì„œ ì˜ˆì™¸ ì²˜ë¦¬í•œë‹¤.
  - ì¸ì¦ ì„±ê³µ ì‹œì—ëŠ” ì˜ˆì™¸ì²˜ë¦¬ë„ê²Œ ë”°ë¡œ ì—†ìœ¼ë¯€ë¡œ ë³´í†µ `AuthenticationFailureHandler`ì—ì„œ ì²˜ë¦¬. 

## ì‹¤ìŠµ 

### ì¸ì¦ ì„±ê³µ ê³¼ì •

![img_26.png](images/s02/form-auth/img_26.png)

![img_27.png](images/s02/form-auth/img_27.png)

![img_28.png](images/s02/form-auth/img_28.png)

- `UsernamePasswordAuthenticationFilter.requiresAuthentication`
  - antPathRequestMatcher ì˜ íŒ¨í„´ì´ `/login`

![img_29.png](images/s02/form-auth/img_29.png)

![img_30.png](images/s02/form-auth/img_30.png)

- `UsernamePasswordAuthenticationFilter.attemptAuthentication` ì—ì„œ 
  `UsernamePasswordAuthenticationToken.unauthenticated` í˜¸ì¶œ 

![img_31.png](images/s02/form-auth/img_31.png)

- `UsernamePasswordAuthenticationFilter.attemptAuthentication` í˜¸ì¶œ ê²°ê³¼ ìƒê¸´ `Authentication`ì˜ êµ¬í˜„ì²´ëŠ” 
  `UsernamePasswordAuthenticationToken`ì´ë‹¤

![img_33.png](images/s02/form-auth/img_33.png)

- this.securityContextRepository.saveContext(context, request, response);
  - ì´ ë•Œ `securityContextRepository` ì„¸ì…˜ storageì´ë‹¤. (`HttpSessionSecurityContextRepository`)

### ì¸ì¦ ì‹¤íŒ¨ ê³¼ì •

![img_34.png](images/s02/form-auth/img_34.png)

- `AuthenticationException` ìºì¹˜

![img_35.png](images/s02/form-auth/img_35.png)

- `security context`ë¥¼ ì´ˆê¸°í™”

# ê¸°ë³¸ ì¸ì¦ - httpBasic()

## HTTP Basic ì¸ì¦ ë°©ì‹

![img.png](images/s02/basic-auth/img.png)

### ğŸš¨ ì£¼ì˜ì‚¬í•­ - Base64ë¡œ ì¸ì½”ë”©í•œ ê°’ì„ í†µì‹ ì— ì‚¬ìš©í•˜ë©´ ì•ˆ ëœë‹¤ 

- username, passwordë¥¼ Base64ë¡œ ì¸ì½”ë”©í•´ì„œ ì„œë²„ì— ì „ë‹¬í•œë‹¤ê³  í–ˆëŠ”ë°,
  - ì´ ë•Œ Base64ë¡œ ì¸ì½”ë”©ëœ ê°’ì€ **ì•”í˜¸í™”ëœ ê°’ì€ ì•„ë‹ˆë‹¤.**
  - Base64ë¡œ ë””ì½”ë”©í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì•”í˜¸ê°€ ë…¸ì¶œë  ìˆ˜ ìˆìœ¼ë©° **ì´ ìƒíƒœë¡œ í†µì‹ ì´ ë˜ë©´ ì•ˆ ëœë‹¤.**
- ë”°ë¼ì„œ HTTP Basic ì¸ì¦ì€ ë°˜ë“œì‹œ HTTPSì™€ ê°™ì´ TLS ê¸°ìˆ ê³¼ í•¨ê»˜ ì‚¬ìš©í•´ì•¼í•œë‹¤.
- ìš”ì¦˜ ì›¹ì—ì„œëŠ” HTTP Basic ì¸ì¦ì€ ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

## ì‹œíë¦¬í‹°ì˜ HTTP Basic ì¸ì¦

![img_1.png](images/s02/basic-auth/img_1.png)

## ì‹¤ìŠµ

![img_2.png](images/s02/basic-auth/img_2.png)

- ìœ„ ì²˜ëŸ¼ ê¸°ë³¸ `httpBasic`ì„ ì„¤ì •í•˜ê³  ë£¨íŠ¸ë¡œ ì ‘ê·¼í•´ë³´ì.

![img_3.png](images/s02/basic-auth/img_3.png)

- ì ‘ê·¼ ê¶Œí•œì´ ì—†ìœ¼ë¯€ë¡œ ì„œë²„ëŠ” Response Headerì— `WWW-Authenticate: Basic realm="Realm"` ì‘ë‹µì„ ë‚´ë ¸ë‹¤. 

![img_4.png](images/s02/basic-auth/img_4.png)

- ì´í›„ í´ë¼ì´ì–¸íŠ¸ ë¸Œë¼ìš°ì €ì—ì„œëŠ” Basic ì¸ì¦ ë°©ì‹ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ í”„ë¡¬í”„íŠ¸ ì°½ì„ ë„ì› ë‹¤.
- ë¡œê·¸ì¸ì— ì„±ê³µí•œ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì.

![img_7.png](images/s02/basic-auth/img_7.png)
![img_8.png](images/s02/basic-auth/img_8.png)

- ìš”ì²­ í—¤ë”ë¥¼ í™•ì¸í•´ë³´ë©´ Base64ë¡œ ì¸ì½”ë”©ëœ `username:password`ë¥¼ í¬í•¨í•œ ê²ƒì„ í™•ì¸ ê°€ëŠ¥.

![img_5.png](images/s02/basic-auth/img_5.png)

- ë¡œê·¸ì¸ì— ì„±ê³µí•˜ê³  ì‘ë‹µ í—¤ë”ë¥¼ ì—´ì–´ë³´ë©´ `WWW-Authenticate` í—¤ë”ëŠ” í¬í•¨ë˜ì§€ ì•ŠëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
  - ì •ìƒ ë¡œê·¸ì¸ í–ˆìœ¼ë¯€ë¡œ ì‘ë‹µ í—¤ë”ì— `WWW-Authenticate`ë¥¼ ì‹¬ì§€ ì•Šì•˜ë‹¤.

### authenticationEntryPoint

![img_9.png](images/s02/basic-auth/img_9.png)

```java
public class CustomAuthenticationEntryPoint implements AuthenticationEntryPoint {

  @Override
  public void commence(
      final HttpServletRequest request,
      final HttpServletResponse response,
      final AuthenticationException authException
  ) throws IOException, ServletException {
    response.setHeader("CUSTOM-Authenticate", "Basic realm=security");
    response.sendError(HttpStatus.UNAUTHORIZED.value(), HttpStatus.UNAUTHORIZED.getReasonPhrase());
  }
}
```

- authenticationEntryPointë¥¼ ì»¤ìŠ¤í…€ í•´ë³´ì.

![img_10.png](images/s02/basic-auth/img_10.png)

- Response í—¤ë”ì— ì»¤ìŠ¤í…€í•œ í—¤ë”ê°’ì´ ë“¤ì–´ìˆëŠ” ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
  - ë‹¨ ì´ê²ƒì„ ë¸Œë¼ìš°ì €ì—ì„œ í•´ì„í•  ìˆ˜ëŠ” ì—†ìœ¼ë¯€ë¡œ í”„ë¡¬í”„íŠ¸ ì°½ì´ ëœ¨ì§€ëŠ” ì•ŠëŠ”ë‹¤.

# ê¸°ë³¸ ì¸ì¦ í•„í„° - BasicAuthenticationFilter

![img_11.png](images/s02/basic-auth/img_11.png)

![img_12.png](images/s02/basic-auth/img_12.png)

- ê¸°ë³¸ì ìœ¼ë¡œ `BasicAuthenticationFilter`ëŠ” ì„¸ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
  - ì„¸ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ë§¤ ìš”ì²­ ì‹œë§ˆë‹¤ ì¸ì¦ì„ í•´ì•¼í•œë‹¤.

## ì‹¤ìŠµ

![img_14.png](images/s02/basic-auth/img_14.png)

- `BasicAuthenticationFilter.doFilterInternal`

![img_13.png](images/s02/basic-auth/img_13.png)

- `BasicAuthenticationConverter.convert`

![img_15.png](images/s02/basic-auth/img_15.png)

- `BasicAuthenticationFilter`ëŠ” ì„¸ì…˜ì„ ì“°ì§€ ì•ŠëŠ”ë‹¤ê³  í–ˆë‹¤. 
  - `UsernamePasswordAuthenticationFilter`ì˜ `securityContextRepository`ê°€ 
    `HttpSessionSecurityContextRepository`(ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€)ì¸ ë°˜ë©´,
  - `BasicAuthenticationFilter`ì˜ `securityContextRepository`ëŠ” ìš”ì²­ë‹¹ ì¸ì¦ì´ ìœ ì§€ë˜ëŠ” 
    RequestAttributeSecurityContextRepository ì´ë‹¤.


# ê¸°ì–µí•˜ê¸° ì¸ì¦ - rememberMe()

## rememberMe()

## ê¸°ì–µí•˜ê¸° ì¸ì¦ í•„í„° - RememberMeAuthenticationFilter

# ìµëª… ì¸ì¦ ì‚¬ìš©ì - anonymous

# ë¡œê·¸ì•„ì›ƒ - logout()

# ìš”ì²­ ìºì‹œ RequestCache / SavedRequest 

